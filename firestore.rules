rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Batches collection: only authenticated users can read/write.
    match /batches/{batchId} {
      allow read, write: if request.auth != null;
    }

    // Counters collection for atomic operations (internal use)
    match /counters/{counterId} {
        allow read, write: if request.auth != null; // Allow backend access
    }

    // Golden Tables: Allow all authenticated users to read.
    // Writes should be managed via the Firebase Console or a future admin interface.
    match /varieties/{docId} {
      allow read: if request.auth != null;
      allow write: if false;
    }

    match /locations/{docId} {
      allow read: if request.auth != null;
      allow write: if false;
    }

    match /sizes/{docId} {
      allow read: if request.auth != null;
      allow write: if false;
    }

    match /suppliers/{docId} {
      allow read: if request.auth != null;
      allow write: if false;
    }

    // Default deny for any other path to ensure security.
    // This rule should come last.
    match /{path=**} {
      allow read, write: if false;
    }
  }
}
