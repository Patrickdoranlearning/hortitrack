# Enhanced Order Form Features

## Form Layout

### Section 1: Order Information Card
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Order Information                                            â”‚
â”‚ Customer details and delivery preferences                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ [Customer Dropdown â–¼]    [Delivery Date: dd/mm/yyyy]       â”‚
â”‚                                                              â”‚
â”‚ [Shipping: Van/Haulier]  [âœ“ Auto Print Documents]          â”‚
â”‚                                                              â”‚
â”‚ [Customer Notes.........]  [Internal Notes............]     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Section 2: Order Items Card

#### Mode Toggle
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Order Mode                                                   â”‚
â”‚ System will automatically allocate...    [Basic] [Specific] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Basic Mode (Default)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Item 1                                              [ðŸ—‘ï¸]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Product: [Lavandula - 2L Pot (150 available) â–¼]            â”‚
â”‚                                                              â”‚
â”‚ â„¹ï¸ System will automatically allocate from available batchesâ”‚
â”‚                                                              â”‚
â”‚ [Qty: 50]  [Price: 5.50]  [VAT: 13.5]  [âœ“ Allow Substitute]â”‚
â”‚                                                              â”‚
â”‚ [Description Override (Optional).........................]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Specific Mode
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Item 1                                              [ðŸ—‘ï¸]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Product: [Lavandula - 2L Pot (150 available) â–¼]            â”‚
â”‚                                                              â”‚
â”‚ â”Œâ”€ Batch Selection Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 150 plants â”€â”€â”€â”   â”‚
â”‚ â”‚                                                       â”‚   â”‚
â”‚ â”‚ Select Specific Batch:                               â”‚   â”‚
â”‚ â”‚ [Auto-allocate (or choose specific batch) â–¼]        â”‚   â”‚
â”‚ â”‚   â””â”€ BTH-001  50 plants  Grade A  Location: GH-1    â”‚   â”‚
â”‚ â”‚   â””â”€ BTH-002  75 plants  Grade A  Location: GH-2    â”‚   â”‚
â”‚ â”‚   â””â”€ BTH-003  25 plants  Grade B  Location: GH-1    â”‚   â”‚
â”‚ â”‚                                                       â”‚   â”‚
â”‚ â”‚ Grade Preference:                                    â”‚   â”‚
â”‚ â”‚ [Grade A] [Grade B] [Grade C] [Any Grade]          â”‚   â”‚
â”‚ â”‚                                                       â”‚   â”‚
â”‚ â”‚ [â„¹ï¸ View All Batch Details â–¼]                       â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚ [Qty: 50]  [Price: 5.50]  [VAT: 13.5]  [âœ“ Allow Substitute]â”‚
â”‚                                                              â”‚
â”‚ [Description Override (Optional).........................]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Batch Details Popover
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Available Batches                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ï¸ BTH-001         50 plants    Grade A                â”‚
â”‚   Location: GH-1    Status: Ready for Sale             â”‚
â”‚   Planted: 2025-10-15                                  â”‚
â”‚                                                         â”‚
â”‚ â˜ BTH-002         75 plants    Grade A                â”‚
â”‚   Location: GH-2    Status: Ready for Sale             â”‚
â”‚   Planted: 2025-10-20                                  â”‚
â”‚                                                         â”‚
â”‚ â˜ BTH-003         25 plants    Grade B                â”‚
â”‚   Location: GH-1    Status: Looking Good               â”‚
â”‚   Planted: 2025-10-25                                  â”‚
â”‚                                                         â”‚
â”‚ 1 batch(es) preferred                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Section 3: Submit Actions
```
[Reset Form]                              [Create Order â†’]
```

## Feature Highlights

### ðŸŽ¯ Basic Mode Features
- âœ… Simple product selection
- âœ… Automatic batch allocation
- âœ… FEFO logic (oldest first)
- âœ… Grade prioritization (A > B > C)
- âœ… Location-aware allocation
- âœ… No batch knowledge needed

### ðŸŽ¯ Specific Mode Features
- âœ… View all available batches
- âœ… Select exact batch by ID
- âœ… Choose grade preference
- âœ… Mark multiple preferred batches
- âœ… See batch details:
  - Batch number
  - Quantity available
  - Grade (A/B/C)
  - Physical location
  - Status
  - Planting date
- âœ… Batch detail popover with checkboxes
- âœ… Real-time stock display

### ðŸ“‹ Order Management Features
- âœ… Multi-line items
- âœ… Add/remove items dynamically
- âœ… Price overrides
- âœ… VAT rate overrides
- âœ… Substitution allowance per line
- âœ… Custom descriptions
- âœ… Customer notes (visible on invoice)
- âœ… Internal notes (team only)
- âœ… Delivery date picker
- âœ… Shipping method selection
- âœ… Auto-print documents option
- âœ… Form validation with inline errors
- âœ… Reset functionality

## User Experience Flow

### Creating a Basic Order
1. **Start**: Click "Create Order" from orders page
2. **Select Customer**: Choose from dropdown
3. **Add Product**: Select variety and size
4. **Set Quantity**: Enter desired quantity
5. **Review**: Price auto-fills from price list
6. **Submit**: Click "Create Order"
7. **Done**: System allocates and creates order

**Time**: ~30 seconds

### Creating a Specific Order
1. **Start**: Click "Create Order" from orders page
2. **Select Customer**: Choose from dropdown
3. **Toggle Mode**: Click "Specific Order" button
4. **Add Product**: Select variety and size
5. **View Batches**: See available batches with details
6. **Choose Preference**: Either:
   - Select one specific batch, OR
   - Choose grade preference, OR
   - Mark preferred batches in popover
7. **Set Quantity**: Enter desired quantity
8. **Submit**: Click "Create Order"
9. **Done**: System allocates per preferences

**Time**: ~60 seconds

## Validation Rules

### Required Fields
- âœ… Customer (must select)
- âœ… At least one order line
- âœ… Product or Variety + Size per line
- âœ… Quantity per line (positive integer)

### Optional Fields
- Delivery date
- Shipping method
- Notes (customer/internal)
- Unit price (defaults to price list)
- VAT rate (defaults to SKU/product default)
- Allow substitute flag
- Description override
- Batch preferences

### Error Messages
- "Provide a productId or both plant variety and size"
- "Quantity must be a positive number"
- "Customer not found"
- "No products configured for this organization"
- "No product found for [variety] [size]"

## Responsive Design

### Desktop (>1024px)
- Two-column layout for form fields
- Side-by-side notes fields
- Batch details in rich popover
- Full batch information visible

### Tablet (768-1024px)
- Two-column layout maintained
- Condensed batch popover
- Touch-friendly buttons

### Mobile (<768px)
- Single-column layout
- Stacked form fields
- Full-width inputs
- Simplified batch selector

## Accessibility

- âœ… Keyboard navigation support
- âœ… Screen reader friendly labels
- âœ… ARIA attributes on interactive elements
- âœ… Focus management
- âœ… High contrast mode compatible
- âœ… Error announcements

## Performance

- âœ… Products loaded server-side
- âœ… Batch data fetched once per page
- âœ… Form state managed client-side
- âœ… Validation runs on submit
- âœ… Optimized re-renders with React Hook Form

---

**Version**: 1.0
**Date**: 2025-12-04
